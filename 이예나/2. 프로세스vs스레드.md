# 프로세스 vs 스레드

<aside>
💡 **프로세스** : 프로그램을 메모리 상에서 실행중인 작업

**스레드** : 프로세스 안에서 실행되는 여러 흐름 단위

**프로세스는 자신만의 고유 공간과 자원을 할당받아 사용**하는데 반해, 
**스레드는 다른 스레드와 공간, 자원을 공유하면서 사용**하는 차이가 존재함

</aside>

[https://www.youtube.com/watch?v=1grtWKqTn50](https://www.youtube.com/watch?v=1grtWKqTn50)

-   실행단위 : cpu core에서 실행하는 하나의 단위로 프로세스와 스레드를 포괄하는 개념
-   프로세스 : 하나의 스레드만을 가지고 있는 단일 스레드 프로세스
-   동시성 : 한 순간에 여러가지 일이 아니라, 짧은 전환으로 여러가지 일을 동시에 처리하는 것처럼 보이는 것

### **프로그램과 프로세스**

-   프로그램은 실행시키기 전에는 그저 코드가 구현되어 있는 파일일 뿐임
    -   프로그램은 실행이 되어서 사용할 수 있는 무언가가 되어야 하는데, 그것이 바로 프로세스임
-   프로그램이 프로세스가 되면서 어떠한 일이 일어날까?
    ![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%89%E1%85%A6%E1%84%89%E1%85%B3%20vs%20%E1%84%89%E1%85%B3%E1%84%85%E1%85%A6%E1%84%83%E1%85%B3%20dc4a7050b6994c1580934de7753a9a7c/Untitled.png)
    1. 프로세스가 필요로 하는 재료들이 메모리에 올라가야함
        - 메모리에는 Code, Data, Heap, Stack
    2. 해당 프로세스에 대한 정보를 담고 있는 PCB(Process Control Block) 블록이 프로세스 생성시 함께 만들어짐

        <aside>
        💡 PCB란?

        - CPU는 한 프로세스가 종료될때까지 수행하는 것이 아니라 여러 프로세스를 중간중간 바꿔가면서 수행함
        - 그러므로 CPU는 수행중인 프로세스를 나갈 때, 이 프로세스의 정보를 어딘가 저장하고 있어야 다음에 이 프로세스를 다시 수행할 때 이전 수행한 작업 그 다음부터 이어서 작업할 수 있다. 이러한 정보를 저장하는 곳이 PCB
          </aside>

        - Pointer : 준비상태나 대가상태의 큐를 구현하기 위해 필요한 포인트
        - Process State : 현재 프로세스 상태를 담음
        - Process Number(ID) : 고유 번호
        - Program Counter : 다음 명령어를 가리킴
        - Registers, Memory limits , List of open files 등등
-   CPU는 한번에 하나의 프로세스밖에 수행할 수 없음
-   다수의 프로세스를 동시에 실행하기 위해, 여러개의 프로세스를 시분할로, 즉 짧은 텀을 반복하면서 전환해서 실행을 시킴 ⇒ **컨텍스트 스위칭**

    ⇒ 컨텍스트 스위칭은 굉장히 피곤하고 복잡

    ⇒ 그래서 등장한게 Thread

-   **Thread** : 경령화된 프로세스 버전
    -   하나의 프로세스 안에 다수의 쓰레드가 있을 떄, 공유되는 자원이 있음
        ![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%89%E1%85%A6%E1%84%89%E1%85%B3%20vs%20%E1%84%89%E1%85%B3%E1%84%85%E1%85%A6%E1%84%83%E1%85%B3%20dc4a7050b6994c1580934de7753a9a7c/Untitled%201.png)
        -   Code, Data, Heap영역을 공통된 자원으로 사용함
        -   각 쓰레드는 Stack부분만 따로 가지고 있음
            ⇒ 효율적
        -   공유되는 자원이 있기 떄문에 이전처럼 컨텍스트 스위칭이 일어날 때, 캐싱 적중률이 올라감

### **멀티 프로세스 & 멀티 쓰레드 ⇒ 처리 방식의 일종**

-   한 어플리케이션에 대한 처리방식
-   한 어플리케이션이 여러 가지 일을 처리해야할 떄가 있음
    ![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%89%E1%85%A6%E1%84%89%E1%85%B3%20vs%20%E1%84%89%E1%85%B3%E1%84%85%E1%85%A6%E1%84%83%E1%85%B3%20dc4a7050b6994c1580934de7753a9a7c/Untitled%202.png)
-   **멀티 프로세스**
    ex. 여러 사용자가 로그인을 요청하는 상황
    ⇒ 한 프로세스는 매번 하나의 로그인만 처리할 수 있기 때문에 동시에 처리할 수 없기 때문에 아래와 같이 부모 프로세스에서 fork를 해서, 자식 프로세스를 여러개 만들어 이를 처리함
    ![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%89%E1%85%A6%E1%84%89%E1%85%B3%20vs%20%E1%84%89%E1%85%B3%E1%84%85%E1%85%A6%E1%84%83%E1%85%B3%20dc4a7050b6994c1580934de7753a9a7c/Untitled%203.png)
    -   자식 프로세스는 부모와 별개의 메모리 영역을 확보하게 됨
-   **멀티 쓰레드**
    -   한 프로세스 내에서 구분지어진 실행 단위임
    -   프로세스 내에서 분리해서 여러 스레드로 나누어서 실행단위가 나뉘어진 것
    -   한 어플리케이션에 대해 작업의 단위가 나뉘어질때가 많음. 각각의 쓰레드가 그 작업들을 담당함.
    ![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%89%E1%85%A6%E1%84%89%E1%85%B3%20vs%20%E1%84%89%E1%85%B3%E1%84%85%E1%85%A6%E1%84%83%E1%85%B3%20dc4a7050b6994c1580934de7753a9a7c/Untitled%204.png)

**이렇게 보면 멀티 쓰레드가 멀티 프로세스보다 훨씬 좋아보이는데 멀티 프로세스를 사용하는 이유는?**

![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%89%E1%85%A6%E1%84%89%E1%85%B3%20vs%20%E1%84%89%E1%85%B3%E1%84%85%E1%85%A6%E1%84%83%E1%85%B3%20dc4a7050b6994c1580934de7753a9a7c/Untitled%205.png)

-   멀티 쓰레드는 긴밀하게 연결되어 있기 때문에 한 스레드에 문제가 생기면 전체 프로세스에 영향이 감
    -   ex. 위 사진, 한 탭에 문제가 생겨도 전체 창이 꺼졌던 internet explorer의 문제
-   크롬 : 멀티 프로세스를 이용하기 떄문에, 멀티탭 간의 영향을 덜 받음

![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%89%E1%85%A6%E1%84%89%E1%85%B3%20vs%20%E1%84%89%E1%85%B3%E1%84%85%E1%85%A6%E1%84%83%E1%85%B3%20dc4a7050b6994c1580934de7753a9a7c/Untitled%206.png)

![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%89%E1%85%A6%E1%84%89%E1%85%B3%20vs%20%E1%84%89%E1%85%B3%E1%84%85%E1%85%A6%E1%84%83%E1%85%B3%20dc4a7050b6994c1580934de7753a9a7c/Untitled%207.png)

### Multi-core

-   멀티 프로세스와 멀티 쓰레드는 처리방식의 일종이기 때문에 소프트웨어분야에 가깝고,
-   멀티 코어는 조금 더 하드웨어의 측면에 가까움
-   동시성, 병렬 처리
    ![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%89%E1%85%A6%E1%84%89%E1%85%B3%20vs%20%E1%84%89%E1%85%B3%E1%84%85%E1%85%A6%E1%84%83%E1%85%B3%20dc4a7050b6994c1580934de7753a9a7c/Untitled%208.png)
    -   동시성 : 짧은 시간에 cup의 시간을 분할해서 동시에 하는 것처럼 보이게 함
    -   병렬 처리 : 물리적으로 여러 코어를 사용ㅎ서 다수의 실행단위를 한 순간에 동시에 처리할 수 있게 해ㅜㅁ
