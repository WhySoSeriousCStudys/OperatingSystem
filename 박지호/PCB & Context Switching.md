# 03. PCB & Context Switching

### Process Management

: CPUê°€ í”„ë¡œì„¸ìŠ¤ê°€ ì—¬ëŸ¬ê°œì¼ ë•Œ, CPU ìŠ¤ì¼€ì¤„ë§ì„ í†µí•´ ê´€ë¦¬í•˜ëŠ” ê²ƒì„ ë§í•¨

ì´ë•Œ, CPUëŠ” ê° í”„ë¡œì„¸ìŠ¤ë“¤ì´ ëˆ„êµ°ì§€ ì•Œì•„ì•¼ ê´€ë¦¬ê°€ ê°€ëŠ¥í•¨.

í”„ë¡œì„¸ìŠ¤ë“¤ì˜ íŠ¹ì§•ì„ ê°–ê³ ìžˆëŠ” ê²ƒ: `process metadata`


ðŸ’¡ **Process Metadata**  
- Process ID
- Process State
- Process Priority
- CPU Registers
- Owner
- CPU Usage
- Memory Usage


ì´ ë©”íƒ€ë°ì´í„°ëŠ” í”„ë¡œì„¸ìŠ¤ê°€ ìƒì„±ë˜ë©´ `PCB(Process Control Block)` ì´ë¼ëŠ” ê³³ì— ì €ìž¥ë¨

### Process Control Block (í”„ë¡œì„¸ìŠ¤ ì œì–´ ë¸”ë¡, íƒœìŠ¤í¬ ì œì–´ ë¸”ë¡)

: í”„ë¡œì„¸ìŠ¤ ë©”íƒ€ë°ì´í„°ë“¤ì„ ì €ìž¥í•´ ë†“ëŠ” ê³³. íŠ¹ì • í”„ë¡œì„¸ìŠ¤ì™€ ì—°ê´€ëœ ì—¬ëŸ¬ ì •ë³´ë¥¼ ìˆ˜ë¡í•˜ë©° ë‹¤ìŒê³¼ ê°™ì€ ì •ë³´ë¥¼ í¬í•¨í•¨

![image](https://user-images.githubusercontent.com/46514182/184569499-6d441eeb-67a9-40c1-9fd0-a742d043ea1a.png)



ðŸ’¡ **ì •ë³´ë“¤**
- **í”„ë¡œì„¸ìŠ¤ ìƒíƒœ**: ìƒíƒœëŠ” new(ìƒˆë¡œìš´), ready(ì¤€ë¹„ì™„ë£Œ), running(ì‹¤í–‰), waiting(ëŒ€ê¸°), halted(ì •ì§€)
- **í”„ë¡œì„¸ìŠ¤ ì¹´ìš´í„°**: í”„ë¡œê·¸ëž¨ ì¹´ìš´í„°ëŠ” ì´ í”„ë¡œì„¸ìŠ¤ê°€ ë‹¤ìŒì— ì‹¤í–‰í•  ëª…ë ¹ì–´ì˜ ì£¼ì†Œë¥¼ ê°€ë¦¬í‚¨ë‹¤
- **CPU ë ˆì§€ìŠ¤í„°ë“¤**: CPU ë ˆì§€ìŠ¤í„°ëŠ” ì»´í“¨í„° êµ¬ì¡°ì— ë”°ë¼ ë‹¤ì–‘í•œ ìˆ˜ì™€ íƒ€ìž…ì„ ê°€ì§„ë‹¤. ë ˆì§€ìŠ¤í„°ì—ëŠ” ì—¬ëŸ¬ê°€ì§€ ìƒíƒœì •ë³´ë“¤ê³¼ í”„ë¡œê·¸ëž¨ì¹´ìš´í„°ëŠ” ë‚˜ì¤‘ì— í”„ë¡œì„¸ìŠ¤ê°€ ê³„ì† ì˜¬ë°”ë¥´ê²Œ ì‹¤í–‰ë˜ë„ë¡í•˜ê¸° ìœ„í•´ì„œ, ì¸í„°ëŸ½íŠ¸ ë°œìƒ ì‹œ ì €ìž¥ë˜ì–´ì•¼ í•¨
- **CPU ìŠ¤ì¼€ì¤„ë§ ì •ë³´**: ì´ ì •ë³´ëŠ” í”„ë¡œì„¸ìŠ¤ì˜ ìš°ì„ ìˆœìœ„, ìŠ¤ì¼€ì¤„ íì— ëŒ€í•œ í¬ì¸í„°ì™€ ë‹¤ë¥¸ ìŠ¤ì¼€ì¤„ ë§¤ê°œë³€ìˆ˜ë“¤ì„ í¬í•¨í•¨
- **ë©”ëª¨ë¦¬ ê´€ë¦¬ ì •ë³´**: ìš´ì˜ì²´ì œì— ì˜í•´ ì‚¬ìš©ë˜ëŠ” ë©”ëª¨ë¦¬ ì‹œìŠ¤í…œì— ë”°ë¼ ê¸°ì¤€ ë ˆì§€ìŠ¤í„°ì™€ í•œê³„ ë ˆì§€ìŠ¤í„° ê°’, ìš´ì˜ì²´ì œê°€ ì‚¬ìš©í•˜ëŠ” ë©”ëª¨ë¦¬ ì‹œìŠ¤í…œì— ë”°ë¼ íŽ˜ì´ì§€ í…Œì´ë¸” ë˜ëŠ” ì„¸ê·¸ë¨¼íŠ¸ í…Œì´ë¸” ë“±ê³¼ ê°™ì€ ì •ë³´ë¥¼ í¬í•¨í•¨
- **íšŒê³„ ì •ë³´**: CPU ì‚¬ìš© ì‹œê°„ê³¼ ê²½ê³¼ëœ ì‹¤ì‹œê°„, ì‹œê°„ ì œí•œ, ê³„ì • ë²ˆí˜¸, job ë˜ëŠ process ë²ˆí˜¸ ë“± í¬í•¨
- **ìž…ì¶œë ¥ ìƒíƒœ ì •ë³´**: í”„ë¡œì„¸ìŠ¤ì—ê²Œ í• ë‹¹ëœ ìž…ì¶œë ¥ ìž¥ì¹˜ë“¤ê³¼ ì—´ë¦° íŒŒì¼ì˜ ëª©ë¡ ë“±ì„ í¬í•¨í•¨


â†’ í”„ë¡œì„¸ìŠ¤ ì œì–´ ë¸”ë¡ì€ í”„ë¡œì„¸ìŠ¤ë§ˆë‹¤ ë‹¬ë¼ì§€ëŠ” ëª¨ë“  ì •ë³´ë¥¼ ì €ìž¥í•˜ëŠ” ì €ìž¥ì†Œì˜ ì—­í• ì„ í•¨

![image](https://user-images.githubusercontent.com/46514182/184569513-911c8de6-1e10-4c7f-a852-a0158da665b6.png)  


```c
í”„ë¡œê·¸ëž¨ ì‹¤í–‰ â†’ í”„ë¡œì„¸ìŠ¤ ìƒì„± â†’ í”„ë¡œì„¸ìŠ¤ ì£¼ì†Œ ê³µê°„ì— (ì½”ë“œ, ë°ì´í„°, ìŠ¤íƒ) ìƒì„±
â†’ ì´ í”„ë¡œì„¸ìŠ¤ì˜ ë©”íƒ€ë°ì´í„°ë“¤ì´ PCBì— ì €ìž¥
```

### PCB ê°€ í•„ìš”í•œ ì´ìœ ?

CPUì—ì„œ í”„ë¡œì„¸ìŠ¤ì˜ êµì²´ ìž‘ì—…(interrupt ë°œìƒ ë“±)ì´ ì´ë£¨ì–´ì§€ëŠ”ë° ì•žìœ¼ë¡œ ë‹¤ì‹œ ìˆ˜í–‰í•  ëŒ€ê¸°ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ì— ê´€í•œ ì •ë³´ë“¤ì€ PCBì— ì €ìž¥í•´ ë‘ê³  ë‚˜ì¤‘ì— ë‹¤ì‹œ í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‚¬ìš©í•  ë•Œ PCBì— ìžˆëŠ” ì •ë³´ë¥¼ ì˜¬ë ¤ì„œ ì´ì–´ì„œ ì‹¤í–‰í•˜ê¸° ìœ„í•¨

### PCB ê´€ë¦¬?

Linked List ë°©ì‹ìœ¼ë¡œ ê´€ë¦¬í•¨

PCB List Headì— PCBë“¤ì´ ìƒì„±ë  ë•Œë§ˆë‹¤ ë¶™ê²Œ ëœë‹¤. ì£¼ì†Œê°’ìœ¼ë¡œ ì—°ê²°ì´ ì´ë£¨ì–´ì ¸ ìžˆëŠ” ì—°ê²° ë¦¬ìŠ¤íŠ¸ì´ê¸° ë•Œë¬¸ì— ì‚½ìž… ì‚­ì œê°€ ìš©ì´í•¨.

â†’ í”„ë¡œì„¸ìŠ¤ê°€ ìƒì„±ë˜ë©´ í•´ë‹¹ PCBê°€ ìƒì„±ë˜ê³ , í”„ë¡œì„¸ìŠ¤ê°€ ì™„ë£Œë˜ë©´ ì œê±°ë¨

### Context Switching

: CPUê°€ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ë¡œ êµí™˜í•˜ë ¤ë©´, ì´ì „ í”„ë¡œì„¸ìŠ¤ì˜ ìƒíƒœë¥¼ PCBì— ë³´ê´€í•˜ê³  ìƒˆë¡œìš´ í”„ë¡œì„¸ìŠ¤ì˜ ìƒíƒœë¥¼ PCBì— ì½ì–´ì„œ ë ˆì§€ìŠ¤í„°ì— ì ìž¬í•˜ì—¬ ë³´ê´€ëœ ìƒíƒœë¥¼ ë³µêµ¬í•˜ëŠ” ìž‘ì—…

ë³´í†µ ì¸í„°ëŸ½íŠ¸ê°€ ë°œìƒí•˜ê±°ë‚˜, ì‹¤í–‰ ì¤‘ì¸ CPU ì‚¬ìš© í—ˆê°€ ì‹œê°„ì„ ëª¨ë‘ ì†Œëª¨í•˜ê±°ë‚˜, ìž…ì¶œë ¥ì„ ìœ„í•´ ëŒ€ê¸°í•´ì•¼í•˜ëŠ” ê²½ìš°ì— Context Switchingì´ ë°œìƒí•¨

`ì¦‰, í”„ë¡œì„¸ìŠ¤ê°€ Ready â†’ Running, Running â†’ Ready, Running â†’ Waitingì²˜ëŸ¼ ìƒíƒœ ë³€ê²½ ì‹œ ë°œìƒí•¨`

**Context Switchingì˜ Overhead?**

: context switchingì´ ì§„í–‰ë  ë™ì•ˆ ì‹œìŠ¤í…œì€ ì•„ë¬´ëŸ° ìœ ìš©í•œ ì¼ì„ í•˜ì§€ ëª»í•˜ê¸° ë•Œë¬¸ì— context switchingì„ í•˜ëŠ” ë™ì•ˆì€ overheadê°€ ë°œìƒí•¨.

ê°ìˆ˜í•´ì•¼í•˜ëŠ” overhead!

> í”„ë¡œì„¸ìŠ¤ë¥¼ ìˆ˜í–‰í•˜ë‹¤ê°€ ìž…ì¶œë ¥ ì´ë²¤íŠ¸ê°€ ë°œìƒí•´ì„œ ëŒ€ê¸° ìƒíƒœë¡œ ì „í™˜ì‹œí‚´
ì´ë•Œ, CPUë¥¼ ê·¸ëƒ¥ ë†€ê²Œ ë†”ë‘ëŠ” ê²ƒë³´ë‹¤ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ë¥¼ ìˆ˜í–‰ì‹œí‚¤ëŠ” ê²ƒì´ íš¨ìœ¨ì 
>
